name: "Trivy Scan"

on:
  push:
    branches: [ main, 'hotfix/**' ]
  pull_request:
    types: [ labeled, opened, reopened, synchronize ]
  schedule:
    - cron: '45 12 * * 1'

jobs:
  scan:
    uses: UKHomeOffice/sas-github-workflows/.github/workflows/trivy-gradle.yml@v2
    with:
      severity: 'UNKNOWN,LOW,MEDIUM,HIGH,CRITICAL'
      checkoutSubmodule: true
    secrets: inherit
